2025-07-19 17:38:01,642 - INFO - --- 开始加载和预处理数据 ---
2025-07-19 17:38:01,944 - INFO - 成功从 mix_0719/1_inputs/graph_entities.json 加载 61159 条原始记录。
2025-07-19 17:38:01,973 - INFO - 处理后剩余 0 个有效三元组。
2025-07-19 17:38:01,973 - INFO - 发现 0 个独特的设备（三元组实体）。
2025-07-19 17:38:01,974 - INFO - 构建词汇表完成: 0 个实体, 1 个关系。
2025-07-19 17:38:01,974 - INFO - 按'设备'为核心进行数据集划分，防止数据泄露...
2025-07-19 17:38:46,764 - INFO - --- 开始加载和预处理数据 ---
2025-07-19 17:38:47,067 - INFO - 成功从 mix_0719/1_inputs/graph_entities.json 加载 61159 条原始记录。
2025-07-19 17:38:47,175 - INFO - 处理后剩余 59442 个有效三元组。
2025-07-19 17:38:47,175 - INFO - 发现 1042 个独特的设备（三元组实体）。
2025-07-19 17:38:47,177 - INFO - 构建词汇表完成: 2071 个实体, 1 个关系。
2025-07-19 17:38:47,177 - INFO - 按'设备'为核心进行数据集划分，防止数据泄露...
2025-07-19 17:38:47,196 - INFO - 数据集划分完成: Train=43465, Valid=10547, Test=5430
2025-07-19 17:38:47,215 - INFO - 
--- 数据加载测试 ---
2025-07-19 17:38:47,215 - INFO - 训练集样本数: 43465
2025-07-19 17:38:47,216 - INFO - 验证集样本数: 10547
2025-07-19 17:38:47,216 - INFO - 测试集样本数: 5430
2025-07-19 17:38:47,222 - INFO - 
--- DataLoader抽样测试 ---
2025-07-19 17:38:47,223 - INFO - Batch keys: dict_keys(['banner_text', 'relation_id', 'target_id'])
2025-07-19 17:38:47,223 - INFO - Banner text (第一个样本): 220 Welcome to ASUS RT-AC86U FTP service.
331 Please specify the password.
...
2025-07-19 17:38:47,224 - INFO - Relation IDs (第一个样本): 0
2025-07-19 17:38:47,224 - INFO - Target IDs (第一个样本): 1826
2025-07-19 17:38:47,224 - INFO - 数据加载模块看起来工作正常！
2025-07-19 17:44:08,323 - INFO - --- 开始加载和预处理数据 ---
2025-07-19 17:44:08,646 - INFO - 成功从 mix_0719/1_inputs/graph_entities.json 加载 61159 条原始记录。
2025-07-19 17:44:08,758 - INFO - 处理后剩余 59442 个有效三元组。
2025-07-19 17:44:08,758 - INFO - 发现 1042 个独特的设备（三元组实体）。
2025-07-19 17:44:08,760 - INFO - 构建词汇表完成: 2071 个实体, 1 个关系。
2025-07-19 17:44:08,760 - INFO - 按'设备'为核心进行数据集划分，防止数据泄露...
2025-07-19 17:44:08,785 - INFO - 数据集划分完成: Train=43465, Valid=10547, Test=5430
2025-07-19 17:44:08,808 - INFO - 
--- 初始化联合模型 ---
2025-07-19 17:44:08,808 - INFO - 从 mix_0719/5_models/all-MiniLM-L6-v2 加载SBERT模型...
2025-07-19 17:44:08,808 - INFO - Load pretrained SentenceTransformer: mix_0719/5_models/all-MiniLM-L6-v2
2025-07-19 17:44:09,337 - INFO - Use pytorch device: cpu
2025-07-19 17:44:09,357 - INFO - 模型已移动到设备: cpu
2025-07-19 17:44:09,362 - INFO - 成功创建模型、优化器和损失函数。
2025-07-19 17:44:09,362 - INFO - SBERT 学习率: 2e-05, 图谱部分学习率: 0.001
2025-07-19 17:44:09,362 - INFO - 
--- 即将开始训练 (此为结构占位) ---
2025-07-19 17:44:09,362 - INFO - 模型和训练组件初始化完成！下一步是实现训练循环。
2025-07-19 17:47:10,969 - INFO - --- 开始加载和预处理数据 ---
2025-07-19 17:47:11,285 - INFO - 成功从 mix_0719/1_inputs/graph_entities.json 加载 61159 条原始记录。
2025-07-19 17:47:11,398 - INFO - 处理后剩余 59442 个有效三元组。
2025-07-19 17:47:11,399 - INFO - 发现 1042 个独特的设备（三元组实体）。
2025-07-19 17:47:11,400 - INFO - 构建词汇表完成: 2071 个实体, 1 个关系。
2025-07-19 17:47:11,400 - INFO - 按'设备'为核心进行数据集划分，防止数据泄露...
2025-07-19 17:47:11,423 - INFO - 数据集划分完成: Train=43465, Valid=10547, Test=5430
2025-07-19 17:47:11,444 - INFO - 
--- 初始化联合模型 ---
2025-07-19 17:47:11,444 - INFO - 从 mix_0719/5_models/all-MiniLM-L6-v2 加载SBERT模型...
2025-07-19 17:47:11,445 - INFO - Load pretrained SentenceTransformer: mix_0719/5_models/all-MiniLM-L6-v2
2025-07-19 17:47:11,917 - INFO - Use pytorch device: cpu
2025-07-19 17:47:11,935 - INFO - 模型已移动到设备: cpu
2025-07-19 17:47:11,936 - INFO - 成功创建模型、优化器和损失函数。
2025-07-19 17:47:11,937 - INFO - 
==================== 开始训练 ====================
2025-07-19 17:47:52,261 - INFO - --- 开始加载和预处理数据 ---
2025-07-19 17:47:52,807 - INFO - 成功从 mix_0719/1_inputs/graph_entities.json 加载 61159 条原始记录。
2025-07-19 17:47:53,035 - INFO - 处理后剩余 59442 个有效三元组。
2025-07-19 17:47:53,035 - INFO - 发现 1042 个独特的设备（三元组实体）。
2025-07-19 17:47:53,039 - INFO - 构建词汇表完成: 2071 个实体, 1 个关系。
2025-07-19 17:47:53,040 - INFO - 按'设备'为核心进行数据集划分，防止数据泄露...
2025-07-19 17:47:53,072 - INFO - 数据集划分完成: Train=43465, Valid=10547, Test=5430
2025-07-19 17:47:53,095 - INFO - 
--- 初始化联合模型 ---
2025-07-19 17:47:53,095 - INFO - 从 mix_0719/5_models/all-MiniLM-L6-v2 加载SBERT模型...
2025-07-19 17:47:53,096 - INFO - Load pretrained SentenceTransformer: mix_0719/5_models/all-MiniLM-L6-v2
2025-07-19 17:47:53,882 - INFO - Use pytorch device: cpu
2025-07-19 17:47:53,911 - INFO - 模型已移动到设备: cpu
2025-07-19 17:47:53,922 - INFO - 成功创建模型、优化器和损失函数。
2025-07-19 17:47:53,927 - INFO - 
==================== 开始训练 ====================
2025-07-19 19:04:59,097 - INFO - --- (mix_0719 v2) 开始加载和预处理数据 ---
2025-07-19 19:04:59,372 - INFO - 成功加载 61159 条原始记录。
2025-07-19 19:07:19,652 - INFO - --- (mix_0719 v2) 开始加载和预处理数据 ---
2025-07-19 19:07:19,962 - INFO - 成功加载 61159 条原始记录。
2025-07-19 19:07:20,097 - INFO - 处理后剩余 59442 个有效三元组。
2025-07-19 19:07:20,097 - INFO - 发现 1042 个独特的设备描述文本。
2025-07-19 19:07:20,097 - INFO - 构建词汇表完成: 1 个关系。
2025-07-19 19:07:20,098 - INFO - 按'设备'为核心进行数据集划分...
2025-07-19 19:07:20,115 - INFO - 数据集划分完成: Train=43465, Valid=10547, Test=5430
2025-07-19 19:07:20,147 - INFO - 
--- (mix_0719 v2) DataLoader抽样测试 ---
2025-07-19 19:07:20,148 - INFO - Batch keys: dict_keys(['banner_text', 'relation_id', 'triple_text'])
2025-07-19 19:07:20,148 - INFO - Banner text (第一个样本): HTTP/1.1 200 OK
Server: Router Webserver
Connection: close
Content-Type: text/ht...
2025-07-19 19:07:20,148 - INFO - Relation ID (第一个样本): 0
2025-07-19 19:07:20,148 - INFO - Triple text (第一个样本): type: router, vendor: TP-LINK, model: WR740N
2025-07-19 19:07:20,148 - INFO - 数据加载模块看起来工作正常！
2025-07-19 19:08:47,052 - INFO - --- (mix_0719 v2) 开始加载和预处理数据 ---
2025-07-19 19:08:47,324 - INFO - 成功加载 61159 条原始记录。
2025-07-19 19:08:47,426 - INFO - 处理后剩余 59442 个有效三元组。
2025-07-19 19:08:47,426 - INFO - 发现 1042 个独特的设备描述文本。
2025-07-19 19:08:47,426 - INFO - 构建词汇表完成: 1 个关系。
2025-07-19 19:08:47,426 - INFO - 按'设备'为核心进行数据集划分...
2025-07-19 19:08:47,443 - INFO - 数据集划分完成: Train=43465, Valid=10547, Test=5430
2025-07-19 19:08:47,457 - INFO - 
--- 初始化联合模型 (v2) ---
2025-07-19 19:08:47,457 - INFO - 从 mix_0719/5_models/all-MiniLM-L6-v2 加载SBERT模型...
2025-07-19 19:08:47,457 - INFO - Load pretrained SentenceTransformer: mix_0719/5_models/all-MiniLM-L6-v2
2025-07-19 19:08:47,856 - INFO - Use pytorch device: cpu
2025-07-20 09:29:50,903 - INFO - --- (mix_0719 v2.1) 开始加载和预处理数据 (全局随机划分) ---
2025-07-20 09:29:51,460 - INFO - 成功加载 61159 条原始记录。
2025-07-20 09:29:53,797 - INFO - 处理后剩余 59442 个有效的 Banner-设备对。
2025-07-20 09:29:53,797 - INFO - 发现 1042 个独特的设备描述文本。
2025-07-20 09:29:53,797 - INFO - 对所有数据对进行全局随机划分...
2025-07-20 09:29:53,867 - INFO - 数据集划分完成: Train=47553, Valid=5944, Test=5945
2025-07-20 09:29:53,902 - INFO - 
--- 初始化联合模型 (v2) ---
2025-07-20 09:29:53,902 - INFO - 从 mix_0719/5_models/all-MiniLM-L6-v2 加载SBERT模型...
2025-07-20 09:29:53,902 - INFO - Load pretrained SentenceTransformer: mix_0719/5_models/all-MiniLM-L6-v2
2025-07-20 09:29:57,847 - INFO - Use pytorch device: cpu
